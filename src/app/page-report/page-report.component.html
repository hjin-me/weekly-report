<mat-card class='report-container'>
  <mat-card-header>
    <mat-card-title>
      <mat-form-field>
        <mat-select placeholder="日期" [(value)]="selectedWeek" (valueChange)="loadData($event)">
          <mat-option *ngFor="let w of weekOptions" [value]="w">
            {{ w.year + '年第' + w.week + '周'}}
          </mat-option>
        </mat-select>
      </mat-form-field>
      <span>工时信息统计</span>
    </mat-card-title>
  </mat-card-header>
  <mat-card-content>
    <div class="filter">
      <div fxLayout="row" fxLayoutGap="8px" fxLayoutAlign="space-between center">
        <mat-form-field fxFlex="grow" class="full-width">
          <mat-select placeholder="按项目过滤" multiple [(value)]="filter.project">
            <mat-option *ngFor="let p of existedProjectList" [value]="p.id">
              <b>{{p.name}}</b> ({{p.id}})
            </mat-option>
          </mat-select>
        </mat-form-field>
        <mat-form-field fxFlex="grow">
          <mat-select placeholder="按小组过滤" multiple [(value)]="filter.team">
            <mat-option *ngFor="let t of teamList" [value]="t">
              {{ t }}
            </mat-option>
          </mat-select>
        </mat-form-field>
        <mat-form-field fxFlex="grow">
          <mat-select placeholder="按人员过滤" multiple [(value)]="filter.user">
            <mat-option *ngFor="let u of userList" [value]="u">
              {{u}}
            </mat-option>
          </mat-select>
        </mat-form-field>
      </div>
    </div>
    <div>
      <table class='report-table' cellspacing='0'>
        <thead>
        <tr>
          <th>项目编码</th>
          <th>任务模块</th>
          <th>合同编码</th>
          <th>小组名称</th>
          <th>人员姓名</th>
          <th>需求人</th>
          <th>工时数量(天)</th>
          <th>说明</th>
          <th>需求方确认</th>
        </tr>
        </thead>
        <tbody>
        <ng-container *ngFor='let v of _reports'>
          <tr *ngFor='let report of v;first as isFirst'>
            <td *ngIf='isFirst' [attr.rowspan]="v.length">
            <span
              [matTooltip]="report.project | project:projects"
              [matTooltipPosition]="'right'"
            >{{report.project}}</span>
            </td>
            <td><span>{{report.task}}</span></td>
            <td></td>
            <td><span>{{report.team}}</span></td>
            <td><span>{{report.reporter}}</span></td>
            <td><span>{{report.requester}}</span></td>
            <td><span>{{report.time}}</span></td>
            <td class='info'
                [matTooltip]="report.problem"
                [matTooltipPosition]="'below'"
            >{{report.info}}
            </td>
            <td></td>
          </tr>
        </ng-container>
        </tbody>
      </table>
    </div>
  </mat-card-content>
</mat-card>
